@model IEnumerable<EmployeeDTO>
@{
    ViewData["Title"] = "Index";
}

@if (!string.IsNullOrEmpty(TempData["Message"] as string))
{
    <div class="alert alert-success">
        @TempData["Message"]
    </div>
}

<h1>Employees</h1>

<a asp-controller="Employee" asp-action="Create" class="btn btn-primary">
    Create New Employee
</a>

<hr />

<!-- Search Box -->
<div class="row mt-4">
    <div class="col-8">
        <input type="text" class="form-control" id="searchInp" placeholder="Search By Name" />
    </div>
</div>

<!-- Results Container -->
<div id="results">
    <!-- Employee Table -->
    <table class="table table-striped table-hover mt-4">
        <thead class="text-center">
            <tr>
                <th>Name</th>
                <th>Image</th>
                <th>Age</th>
                <th>Salary</th>
                <th>Email</th>
                <th>Department</th>
                <th>Is Active</th>
                <th>Gender</th>
                <th>Employee Type</th>
                <th>Details</th>
                <th>Update</th>
                <th>Delete</th>
            </tr>
        </thead>

    <tbody class="text-center" id="employeeList">
        @foreach (var employee in Model)
        {
            <tr>
                <td>@Html.DisplayFor(X => employee.Name)</td>
                <td>@Html.DisplayFor(X => employee.ImageUrl)</td>
                <td>@Html.DisplayFor(X => employee.Age)</td>
                <td>@Html.DisplayFor(X => employee.Salary)</td>
                <td>@Html.DisplayFor(X => employee.Email)</td>
                <td>@Html.DisplayFor(X => employee.Department)</td>
                <td>@Html.DisplayFor(X => employee.IsActive)</td>
                <td>@Html.DisplayFor(X => employee.Gender)</td>
                <td>@Html.DisplayFor(X => employee.EmployeeType)</td>
                <partial name="_ButtonsPartial" model="@employee.Id" />
            </tr>
        }
    </tbody>
</table>

</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $("#searchInp").on("input", function () {
                let term = $(this).val();

                $.ajax({
                    url: "https://localhost:7099/Employee/Search",
                    type: "GET",
                    data: { term: term },
                    success: function (result) {
                        $("#results").html(result);
                    },
                    error: function () {
                        alert("Something went wrong while searching.");
                    }
                });
            });
        });
    </script>
}




